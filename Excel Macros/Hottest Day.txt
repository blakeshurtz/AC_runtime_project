Sub tally()
Do Until IsEmpty(ActiveCell.Offset(0, -1))
    If ActiveCell.Offset(0, -1) = 0 And ActiveCell.Offset(-1, -1) = 0 Then
    ActiveCell.Offset(1, 0).Select
    ElseIf ActiveCell.Offset(0, -1) = 1 Then
    i = 1 + i
    ActiveCell.Offset(1, 0).Select
    ElseIf ActiveCell.Offset(0, -1) = 0 And ActiveCell.Offset(-1, -1) <> 0 Then
    ActiveCell.Offset(-i, 0).Value = i
    i = 0
    ActiveCell.Offset(1, 0).Select
    End If
Loop
End Sub

---
Sub deleterow()
Do Until IsEmpty(ActiveCell.Offset(0, -1))
    If ActiveCell.Value = "" Then
    Selection.EntireRow.delete
    Else
    ActiveCell.Offset(1, 0).Select
    End If
Loop
End Sub




